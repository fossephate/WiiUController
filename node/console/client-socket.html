<html>

<head>

	<title>Lagless audio host socket</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.0/socket.io.js"></script>
</head>

<body>
	<script>
		
		let socket = io("https://twitchplaysnintendoswitch.com", {
			path: "/8110/socket.io",
			transports: ["websocket"],
		});
		let audio = document.createElement("audio");
		
		
		socket.on("send-audio", function (data) {
			var blob = new Blob([data], { "type" : "audio/ogg; codecs=opus" });
			var oldAudio = audio;
			audio = document.createElement("audio");
			audio.src = window.URL.createObjectURL(blob);
			audio.loop = true;// so that something plays in the gaps
			audio.play();
			audio.playbackRate = 0.95;
			
			setTimeout(function(){
				oldAudio.pause();
			}, 10);
		});

		
		
	</script>
</body>

</html>